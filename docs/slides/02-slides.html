<!DOCTYPE html>
<html>
  <head>
    <title>Day 2</title>
    <meta charset="utf-8">
    <meta name="author" content="Michael W. KearneyðŸ“Š School of Journalism  Informatics Institute  University of Missouri" />
    <link href="lib/remark-css/robot.css" rel="stylesheet" />
    <link href="lib/remark-css/robot-fonts.css" rel="stylesheet" />
    <link href="lib/font-awesome/css/fa-svg-with-js.css" rel="stylesheet" />
    <script src="lib/font-awesome/js/fontawesome-all.min.js"></script>
    <script src="lib/font-awesome/js/fa-v4-shims.min.js"></script>
    <link rel="stylesheet" href="css/slides.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Day 2
## Descriptive statistics
### Michael W. KearneyðŸ“Š<br/>School of Journalism <br/>Informatics Institute <br/>University of Missouri
### <table style="border-style:none;padding-top:30px;" class=".table">
<tr>
<th style="padding-right:75px!important">
<a href="https://twitter.com/kearneymw"> <i class="fa fa-twitter"></i> </a>
</th>
<th style="padding-left:75px!important">
<a href="https://github.com/mkearney"> <i class="fa fa-github"></i> </a>
</th>
</tr>
<tr style="background-color:#fff">
<th style="padding-right:75px!important">
<a href="https://github.com/mkearney"> <span class="citation">@kearneymw</span> </a>
</th>
<th style="padding-left:75px!important">
<a href="https://github.com/mkearney"> <span class="citation">@mkearney</span> </a>
</th>
</tr>
</table>

---





## Overview
+ Review
   - Sampling
   - Variables
   - Object classes in R
+ Descriptives
   - Central tendency
   - Dispersion

---
class: inverse, center, middle

# But first, some admin...

---

## Qualtrics
+ Access your Mizzou Qualtrics account: [https://missouri.qualtrics.com/](missouri.qualtrics.com)
  + You should have a survey, `JOURN_8016_FA18`, shared with you
  + Browse the questions or click *preview* to view the survey
+ The survey will include at least the following...

---

## Health comm experiment

Effect of **source ideology** and **message direction** in vaccine-related articles shared on Twitter

+ Design: 3 (conservative/liberal/moderate) X 3 (pro/anti/neutral)
+ Nine conditions
   - Conservative source + pro/anti/neutral-vaccine
   - Liberal source + pro/anti/neutral-vaccine
   - Moderate source + pro/anti/neutral-vaccine

---

## Outcome variables
+ Perceived source credibility
+ Perceived political bias

---

## Other variables
+ Media diet
+ Demographics
+ What else? (doesn't have to be related to experiment)

---
class: inverse, center, middle

# Sampling

---

## Random\* sample
+ \* Technically, there are multiple kinds of random distributions
   - We typically assume a "uniform" random sample
- Everyone in a sampling frame (all possible data points) has an equal probability of being selected
- Best method for making inferences but expensive and difficult to do

---

## Quasi-random sample
- Samples that use mathematical rules but lack access to the full population
- One common technique is **probability matching**, which is when you match the demographics in a sample with the desired population

---

## Snowball sample
- When you use one/some to recruit more into the sample
- Not very representative, but useful for getting access to niche or hard-to-reach groups

---

## Convenience sample
- A sample that is not random but selected largely due to convenience (low cost, ease of access, etc.)

---

## Why care about sampling?
- The sampling method and study design has a direct effect on one's ability to make **inferences** from data
- **Inferential statistics** are conclusions drawn from a sample and applied to a population
- **Descriptive statistics** are conclusions drawn about a population

---
class: inverse, center, middle

# Variables

---

## Variable
- A **constant** is a fixed value that never changes
    - e.g., pi, the number 1, etc.
- A **variable** is a value that differs across observations
    - can often be thought of as features or characteristics

---

## Variable values
- **Values** are measurements (observations) on a given variable
    - e.g., Tracy's height (variable) is `6'6''` (value)
    - e.g., Avery's final race position (variable) is `1` (value)
    - e.g., Cory's skill level in chess (variable) is `master` (value)
    - e.g., Rory's hometown (variable) is `Kansas City` (value)
- Different levels of measurement enable different levels of analysis

---

## Levels of measurement
- **Nominal**: values represent different categories [or named things]
- **Ordinal**: values represent meaningful sequence
- **Interval**: values represent meaningful sequence using equi-distant intervals
- **Ratio**: values represent real numbers

---

## Nominal
Values represent different categories [or named things]

- Can be used to operationalize anything
- This is often done using *dummy codes*

---

## Ordinal
Values represent meaningful sequence

- The order people finish in a race
- The distance from 1st to 2nd can vary wildly with the distance from 2nd to 3rd

---

## Interval
Values represent meaningful sequence using equi-distant intervals

- Likert-type items, e.g., *I always make my bed in the morning: Strongly Agree... Strongly Disagree* and other survey items that measure a range of feelings/attitudes using numbers
- This is why the visual representation of numbers on a survey is often important


---
## Ratio 
Values represent real numbers

- Numbers correspond to some non-arbitrary meaning.
- A true 0 (zero) exists

---

## Temperature
**Do the statements below add up?**

- The temperature today is 100 degrees Fahrenheit
- The temperature yesterday was 50 degrees Fahrenheit
- Today is twice as hot as yesterday

---

## Fahrenheit
What if we convert the Farenheit values to Celsius

- `100 F == 38 C`
- `50 F == 10 C`

---

## Celsius
**Do the statements below add up?**

- The temperature today is 38 degrees Celsius
- The temperature yesterday was 10 degrees Celsius
- Today is twice as hot as yesterday

---

## Zero degrees
**Does your scale have a meaningful zero?**

+ In theory, `0` should mean a complete lack or absence of the variable
+ For temperature, this is called a Kelvin scale

---

## Kelvin scale
What if we convert the values to Kelvin

- `100 F == 38 C == 311 K`
- `050 F == 10 C == 283 K`

---

## Kelvin
**Do the statements below add up?**

- The temperature today is 311 degrees Kelvin
- The temperature yesterday was 283 degrees Kelvin
- Today is twice as hot as yesterday

---

## Actual temperature ratios
**Fahrenheit** (2x)

```r
100/50
#&gt; [1] 2
```

**Celcius** (3.8x)

```r
38/10
#&gt; [1] 3.8
```

**Kelvin** (1.1x)

```r
311/283
#&gt; [1] 1.09894
```



---
class: inverse, center, middle

# R packages

---
## Install packages
+ Install the [tidyverse](https://tidyverse.org) set of packages (dplyr, tibble, purrr, ggplot2, readr, tidyr, etc.)


```r
## tidyverse actaully consists of several packages
install.packages("tidyverse")
```

---
## Load packages
+ Load packages with `library()`


```r
## note: you don't need to quote the package name
library(tidyverse)
```

+ Or specify the package directly when using a function


```r
## select cyl and mpg columns in built-in mtcars data
dplyr::select(mtcars, cyl, mpg)
#&gt;                     cyl  mpg
#&gt; Mazda RX4             6 21.0
#&gt; Mazda RX4 Wag         6 21.0
#&gt; Datsun 710            4 22.8
#&gt; Hornet 4 Drive        6 21.4
#&gt; Hornet Sportabout     8 18.7
#&gt; Valiant               6 18.1
#&gt; Duster 360            8 14.3
#&gt; Merc 240D             4 24.4
#&gt; Merc 230              4 22.8
#&gt; Merc 280              6 19.2
#&gt; Merc 280C             6 17.8
#&gt; Merc 450SE            8 16.4
#&gt; Merc 450SL            8 17.3
#&gt; Merc 450SLC           8 15.2
#&gt; Cadillac Fleetwood    8 10.4
#&gt; Lincoln Continental   8 10.4
#&gt; Chrysler Imperial     8 14.7
#&gt; Fiat 128              4 32.4
#&gt; Honda Civic           4 30.4
#&gt; Toyota Corolla        4 33.9
#&gt; Toyota Corona         4 21.5
#&gt; Dodge Challenger      8 15.5
#&gt; AMC Javelin           8 15.2
#&gt; Camaro Z28            8 13.3
#&gt; Pontiac Firebird      8 19.2
#&gt; Fiat X1-9             4 27.3
#&gt; Porsche 914-2         4 26.0
#&gt; Lotus Europa          4 30.4
#&gt; Ford Pantera L        8 15.8
#&gt; Ferrari Dino          6 19.7
#&gt; Maserati Bora         8 15.0
#&gt; Volvo 142E            4 21.4
```

---
class: inverse, center, middle

# Object classes in R

---

## Character/Factor
- I will refer to nominal variables as categorical variables
   + Variables with only two categories, we call *dichotomous*
- Categorical variables are represented in R as `character` and `factor`


```r
## character vector containing values a, b, and c
x &lt;- c('a', 'b', 'c')
x
#&gt; [1] "a" "b" "c"
class(x)
#&gt; [1] "character"

## factor vector containing [finite] values a, b, and c
x &lt;- factor(c('a', 'b', 'c'))
x
#&gt; [1] a b c
#&gt; Levels: a b c
class(x)
#&gt; [1] "factor"
```

---
## Character
+ Character vectors can be any textual representations
   - Unlike factors, characters are not limited to a finite set of possibilities


```r
## character vector
x &lt;- c("a", "a", "a", "b", "b", "c")

## table function returns frequency count
table(x)
#&gt; x
#&gt; a b c 
#&gt; 3 2 1

## convert character to factor
f &lt;- as.factor(x)
f
#&gt; [1] a a a b b c
#&gt; Levels: a b c
```


---
## Factor
+ Factor vectors are labelled integers representing a finite number of categories


```r
## try to convert character (x) to numeric
x &lt;- c("a", "a", "a", "b", "b", "c")
try(as.numeric(x))
#&gt; Warning in doTryCatch(return(expr), name, parentenv, handler): NAs
#&gt; introduced by coercion
#&gt; [1] NA NA NA NA NA NA

## convert factor (f) to numeric
f &lt;- as.factor(x)
as.numeric(f)
#&gt; [1] 1 1 1 2 2 3
```

---
## Factor
+ Factors can preserve information about levels/categories even if they are not observed


```r
## likert-type observations
x &lt;- c("Agree", "Neither", "Agree", "Agree")
table(x)
#&gt; x
#&gt;   Agree Neither 
#&gt;       3       1

## convert factor (f) to numeric
x &lt;- factor(x, levels = c("Agree", "Neither", "Disagree"))
table(x)
#&gt; x
#&gt;    Agree  Neither Disagree 
#&gt;        3        1        0
```


---

## Integer
- In R, we refer to **discrete** numbers as `integer`


```r
## R assumes numbers are continuous (numeric)
x &lt;- c(1, 2, 3)
class(x)
#&gt; [1] "numeric"

## use "L" after whole numbers to indicate integer
x &lt;- c(1L, 2L, 3L)
class(x)
#&gt; [1] "integer"
```


---

## Numeric
- In R, we refer to **continuous** interval and ratio variables as `numeric`
- Values are continuous if they don't only exist as discrete units


```r
x &lt;- c(1.25, -3.5, 4)
class(x)
#&gt; [1] "numeric"
```


---

## Data frames
+ Tabular data (like in Excel) is called a `data.frame`
   - Tibbles (`tbl_df`) are special cases of data frames
+ Data frames contain rows (observations) and columns (variables)
   - Variables can be of different classes


```r
## dplyr data_frame is a useful version of base data.frame()
df &lt;- dplyr::data_frame(
  cat = c("a", "b", "c", "a"),
  int = c(1L, 2L, 1L, 3L),
  num = c(-4.3, 3.14, 2, 0.10)
)
df
#&gt; # A tibble: 4 x 3
#&gt;   cat     int   num
#&gt;   &lt;chr&gt; &lt;int&gt; &lt;dbl&gt;
#&gt; 1 a         1 -4.3 
#&gt; 2 b         2  3.14
#&gt; 3 c         1  2   
#&gt; 4 a         3  0.1
```

---
class: inverse, center, middle

# Descriptive statistics

---

## "Statistics"
+ **Descriptive** statistics (AKA *parametrics*)
    - Describing the population of data
    - Not a lot of probability theory required
+ **Inferential** statistics (AKA *statistics*)
    - Describing the population using a sample of data
    - Probability theory is key

---

## Descriptive statistics
+ Measures of **central tendency**
    - Describes the **middle** of the data
+ Measures of dispersion
    - Describes the **spread** of the data

---

## Central tendency
+ **Mean**: the expected value (often called "average")
+ **Median**: the mid-point of the data
+ **Mode**: the most common data point

---

## Mean
+ Calculate the mean `mean()` by summing `sum()` all values and dividing `/` by the number of values `length()`


```r
## 10 numbers from random distribution with mean of 0
x &lt;- rnorm(10, mean = 0)

## calculate mean
sum(x) / length(x)
#&gt; [1] -0.523909

## use mean function
mean(x)
#&gt; [1] -0.523909
```

---

## Median
+ Calculate the median `median()` by arranging `sort()` all values and find the middle (or values *tied* for the middle) observation.


```r
## sort the numbers by magnitude
x &lt;- sort(x)

## print and find the middle values (5th and 6th)
x
#&gt;  [1] -3.003892 -1.494294 -1.164791 -0.502857 -0.401837 -0.299097 -0.277658
#&gt;  [8]  0.167901  0.747199  0.990236

## use median function
median(x)
#&gt; [1] -0.350467
```

---

## Mode
+ Calculate the mode by creating a frequency table `table()` and sorting `sort()` in descending order (biggest to smallest)


```r
## sample 100 values from the series of numbers 1:10 (1, 2, 3, 4, 5, 6, 7, 8, 9, 10)
y &lt;- sample(1:10, 100, replace = TRUE)

## create frequency table
y_freq &lt;- table(y)

## sort and print table
sort(y_freq, decreasing = TRUE)
#&gt; y
#&gt;  6  3  8  1  4  5  9 10  2  7 
#&gt; 17 13 13 10  9  9  9  8  6  6
```

---

## Important R note
+ In R missing values are coded as `NA`
+ Inputs containing `NA` will return `NA` for these functions:
    - `sum()`, `mean()`, `median()`, `min()`, `max()`, `range()`, `var()`, `sd()`
+ To avoid this, include the argument `na.rm = TRUE`

&lt;br&gt;

&lt;p class="note"&gt;Assuming you are **aware** of missing data, it is usually (though not always) desirable to omit `NA` values via `na.rm = TRUE`.&lt;/p&gt;

---
## `na.rm = TRUE`
+ Example of finding mean when `x` contains a missing value (`NA`)

```r
## add missing value ot x
x &lt;- c(NA, x)

## returns NA
mean(x)
#&gt; [1] NA

## returns the mean we want
mean(x, na.rm = TRUE)
#&gt; [1] -0.523909
```

---

## Dispersion
+ **Range**: the minimum and maximum values. Often expressed as a distance between the two.
+ **Variance**: distance from the mean
+ **Standard deviation**: distance from the mean expressed in standardized units

---

## Range
+ Calculate the range `range()` by finding the maximum `max()` and minimum `min()` values.


```r
## min and max values of y
min(y)
#&gt; [1] 1
max(y)
#&gt; [1] 10

## calculate distance between the two
max(y) - min(y)
#&gt; [1] 9

## use the range function
range(y)
#&gt; [1]  1 10
```

---

## Variance
+ Calculate the variance `var()` by summing `sum()` the squared `^2` distance `-` from the mean `mean()` and dividing `/` by the number of observations `length(x) - 1`


```r
## calculate variance
sum((y - mean(y))^2) / (length(y) - 1)
#&gt; [1] 7.58576

## use the var function
var(y)
#&gt; [1] 7.58576
```

---

## Standard deviation
+ Calculate the standard deviation `sd()` by taking the square root `sqrt()` of the variance `var()`.


```r
## calculate variance
yvar &lt;- var(y)

## square root of variance
sqrt(yvar)
#&gt; [1] 2.75423

## use sd function
sd(y)
#&gt; [1] 2.75423
```

&lt;!-- ############################################# --&gt;
&lt;!-- ##         GETTING DATA INTO R             ## --&gt;
&lt;!-- ############################################# --&gt;

---
class: inverse, center, middle

# Getting data into R

---

## CSV
+ **CSV**: comma separated value

```r
## readr is in the tidyverse
d &lt;- readr::read_csv("data/csv.csv")
#&gt; Parsed with column specification:
#&gt; cols(
#&gt;   id = col_integer(),
#&gt;   name = col_character(),
#&gt;   amount = col_integer()
#&gt; )
d
#&gt; # A tibble: 2 x 3
#&gt;      id name  amount
#&gt;   &lt;int&gt; &lt;chr&gt;  &lt;int&gt;
#&gt; 1     1 Alice    100
#&gt; 2     2 Bob      200
```

---

## \*SV/delimited

```r
## uncomment following line for help documentation
#?read.table
d &lt;- read.delim("data/tsv.tsv")
d
#&gt;        x1   x2   x3 x4
#&gt; 1 234.000 10.0  1.5  a
#&gt; 2   0.234  3.0 15.0  b
#&gt; 3  -5.200 -5.3  0.0  c
```

---

## dat
+ Wikipedia describes `.dat` as

&gt; not [a] specific file type, often generic extension for "data" files for a variety of applications

+ Often associated with Mplus (statistical software program)
+ See: \*SV methods, i.e., `read.table()`

---

## xlsx (Excel)

```r
## install readxl package if not already
if (!requireNamespace("readxl", quietly = TRUE)) {
  install.packages("readxl")
}
## read an excel file
d &lt;- readxl::read_excel("data/xlsx.xlsx")
#&gt; Warning: The `validate` argument to `as_tibble()` is deprecated. Please use
#&gt; `.tidy_names` to control column names.
d
#&gt; # A tibble: 4 x 2
#&gt;   name                 value    
#&gt;   &lt;chr&gt;                &lt;chr&gt;    
#&gt; 1 Name                 Clippy   
#&gt; 2 Species              paperclip
#&gt; 3 Approx date of death 39083    
#&gt; 4 Weight in grams      0.9
```

---

## .sav (SPSS)

```r
## install readxl package if not already
if (!requireNamespace("haven", quietly = TRUE)) {
  install.packages("haven")
}
## read spss (sav) file
d &lt;- haven::read_spss("data/sav.sav")
d
#&gt; # A tibble: 32 x 2
#&gt;    toxin yield
#&gt;    &lt;dbl&gt; &lt;dbl&gt;
#&gt;  1    11     4
#&gt;  2    19     4
#&gt;  3    13     4
#&gt;  4    13     4
#&gt;  5    12     4
#&gt;  6    17     4
#&gt;  7    13     4
#&gt;  8    18     4
#&gt;  9    18     4
#&gt; 10    17     4
#&gt; # â€¦ with 22 more rows
```

---

## dta (Stata)

```r
## install readxl package if not already
if (!requireNamespace("haven", quietly = TRUE)) {
  install.packages("haven")
}
## read stata (dta) file
d &lt;- haven::read_stata("data/dta.dta")
d
#&gt; # A tibble: 2 x 8
#&gt;   datetime_c          datetime_big_c      date       weekly_date
#&gt;   &lt;dttm&gt;              &lt;dttm&gt;              &lt;date&gt;           &lt;dbl&gt;
#&gt; 1 2006-11-19 23:13:20 2006-11-19 22:57:03 2010-01-20        2601
#&gt; 2 1959-12-31 20:03:20 1959-12-31 23:35:21 1953-10-02        -601
#&gt; # â€¦ with 4 more variables: monthly_date &lt;dbl&gt;, quarterly_date &lt;dbl&gt;,
#&gt; #   half_yearly_date &lt;dbl&gt;, yearly_date &lt;dbl&gt;
```

---

## rds (R)

```r
## my favorite
d &lt;- readRDS("data/rds.rds")
d
#&gt; # A tibble: 88 x 18
#&gt;    expertise   MR1   MR2   MR3   MR4   MR6   MR7   MR8   MR9   MR5  MR10
#&gt;    &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#&gt;  1 news preâ€¦  0.99     0     0     0     0     0     0     0     0     0
#&gt;  2 page layâ€¦  0.99     0     0     0     0     0     0     0     0     0
#&gt;  3 history â€¦  0.99     0     0     0     0     0     0     0     0     0
#&gt;  4 databases  0.99     0     0     0     0     0     0     0     0     0
#&gt;  5 graphic â€¦  0.99     0     0     0     0     0     0     0     0     0
#&gt;  6 programmâ€¦  0.99     0     0     0     0     0     0     0     0     0
#&gt;  7 practiceâ€¦  0.99     0     0     0     0     0     0     0     0     0
#&gt;  8 data visâ€¦  0.99     0     0     0     0     0     0     0     0     0
#&gt;  9 data-driâ€¦  0.99     0     0     0     0     0     0     0     0     0
#&gt; 10 data jouâ€¦  0.99     0     0     0     0     0     0     0     0     0
#&gt; # â€¦ with 78 more rows, and 7 more variables: MR13 &lt;dbl&gt;, MR11 &lt;dbl&gt;,
#&gt; #   MR14 &lt;dbl&gt;, MR12 &lt;dbl&gt;, MR15 &lt;dbl&gt;, MR16 &lt;dbl&gt;, var &lt;fct&gt;
```

---

## rda/Rdata

```r
## try to avoid this one
load("data/rds.rda")
```


&lt;!-- ############################################# --&gt;
&lt;!-- ##           DESCRIPTIVES IN R             ## --&gt;
&lt;!-- ############################################# --&gt;

---
class: center, middle, inverse

# Write up

---

## Data
+ After data collection and prior to analysis, research projects should describe, or summarize, the data
+ This should be included in the **methods** section of your paper
+ Descriptives for:
    - Participants
    - Variables

---

## Participants
+ Descriptives in the data summary typically include the following
    - Number of observations (total number `N = 345`)
    - Demographic (age, sex, race, education, etc.) breakdowns (numbers and percents *15.3% were female* (`n = 23`))
        - For age, usually a range and the mean

---

## Variables
+ Study variable information: 
    - min
    - max
    - mean
    - sd
+ Correlation table (don't worry about that yet)

---

## Useful functions/packages
+ Fortunately, there are lots of good functions and packages to choose from
    - `summary()` (base R)
    - `psych::describe()`
    - `skimr::skim()`
    - `summarize()`

---

class: center, middle, inverse

# Assignment

---
## Assignment
+ We'll work through this one together


---
class: center, middle, inverse

# Rmarkdown

---

## Rmarkdown
+ The **{rmarkdown}** package provides a simple front-end framework that (a) is well integrated into R uses and functions and (b) plays well with others front-end frameworks (html, PDF, even Word docs)
+ **Rstudio**, in particular, makes it easy to access cool rmarkdown features
+ Thus, this presentation provides a brief introduction to **rmarkdown**


---

## What is markdown?
+ **Markdown** is a simple markup language written in plain text. It's how I make all these slides and write papers
+ **Rmarkdown** is a version of markdown that integrates the R environment (code and output) via **code chunks**


---

## How do I use it?
+ In **Rstudio** select the new file dropdown (or `File &gt; New File`) and then select **R Markdown**.

![](img/rmd.png)


---

## Render
+ To render the `.Rmd` file, click the **knit** button on the top pane of the script file. 

![](img/rmd_rstudio.png)


---

## Very simple rules:
+ R code exists inside of **code chunks**
    - Every time you click `knit`, the file [and the code] is executed
+ Everything outside of code chunks gets converted to HTML text (similar to Word).
    - There are lots of good examples and tutorials online, just google "Rmarkdown tutorials"
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function() {
  var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})();</script>

<script>
(function() {
  var i, text, code, codes = document.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
})();
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
