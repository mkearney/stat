<!DOCTYPE html>
<html>
  <head>
    <title>Day 4</title>
    <meta charset="utf-8">
    <meta name="author" content="Michael W. KearneyðŸ“Š School of Journalism  Informatics Institute  University of Missouri" />
    <link href="lib/remark-css/robot.css" rel="stylesheet" />
    <link href="lib/remark-css/robot-fonts.css" rel="stylesheet" />
    <link href="lib/font-awesome/css/fa-svg-with-js.css" rel="stylesheet" />
    <script src="lib/font-awesome/js/fontawesome-all.min.js"></script>
    <script src="lib/font-awesome/js/fa-v4-shims.min.js"></script>
    <script src="lib/htmlwidgets/htmlwidgets.js"></script>
    <script src="lib/jquery/jquery.min.js"></script>
    <link href="lib/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
    <script src="lib/datatables-binding/datatables.js"></script>
    <link href="lib/dt-core-bootstrap/css/dataTables.bootstrap.min.css" rel="stylesheet" />
    <link href="lib/dt-core-bootstrap/css/dataTables.bootstrap.extra.css" rel="stylesheet" />
    <script src="lib/dt-core-bootstrap/js/jquery.dataTables.min.js"></script>
    <script src="lib/dt-core-bootstrap/js/dataTables.bootstrap.min.js"></script>
    <link href="lib/crosstalk/css/crosstalk.css" rel="stylesheet" />
    <script src="lib/crosstalk/js/crosstalk.min.js"></script>
    <link rel="stylesheet" href="css/slides.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Day 4
## Correlations and factor analysis
### Michael W. KearneyðŸ“Š<br/>School of Journalism <br/>Informatics Institute <br/>University of Missouri
### <table style="border-style:none;padding-top:30px;" class=".table">
<tr>
<th style="padding-right:75px!important">
<a href="https://twitter.com/kearneymw"> <i class="fa fa-twitter"></i> </a>
</th>
<th style="padding-left:75px!important">
<a href="https://github.com/mkearney"> <i class="fa fa-github"></i> </a>
</th>
</tr>
<tr style="background-color:#fff">
<th style="padding-right:75px!important">
<a href="https://twitter.com/kearneymw"> <span class="citation">@kearneymw</span> </a>
</th>
<th style="padding-left:75px!important">
<a href="https://github.com/mkearney"> <span class="citation">@mkearney</span> </a>
</th>
</tr>
</table>

---

class: inverse, center, middle



## Agenda

---

## Agenda
1. Co-variance
   - What is covariance?
   - Calculating covariance
1. Correlations
   - Bivariate correlations
   - Correlation matrices
1. Factor analysis
   - What is a factor?
   - Calculating scores
   - Reliability
---
class: inverse, center, middle

## Co-variance

---

## Variation (review)

**Variance**: average distance from the mean

`$$s^2=\frac{\sum (x - \bar{x})^2}{n - 1}$$`

+ Single variable: `\(x\)`
+ Always positive: `\((x - \bar{x})^2\)`


---

## Co-variation

**Covariance**: average *related* distance**s** from the mean

`$$cov_{(x, y)} = \frac{\sum (x-\bar{x})(y-\bar{y})}{n - 1}$$`

+ Two variables: `\(x\)` and `\(y\)`
+ Can be positive or negative
   - Positive means vary [above/below mean] together
   - Negative means vary [above/below mean] inversely

---

## Notable:

When a variable covaries with itself...

`$$cov_{(x, x)} = \frac{\sum (x-\bar{x})(x-\bar{x})}{n - 1}$$`

it's actually just representing the variance:

`$$s^2=\frac{\sum (x - \bar{x})^2}{n - 1}$$`

---

## Correlation

A **correlation** describes how variation in one variable relates to variation in another variable. 

In statistics, correlations describe the **magnitude** and **direction** of a relationship between two variables. 


---


```r
## create data frame with x and y coming from random normal draws
df &lt;- data_frame(x = rnorm(20), y = x + rnorm(20))

## scatter plot
ggplot(df, aes(x, y)) + 
  geom_point() + 
  labs(title = "Scatter plot of y by x") + 
  ggsave("img/scatter_plot.png", width = 8, height = 4.75, units = "in")
```

&lt;p style="align:center"&gt; &lt;img src="img/scatter_plot.png" /&gt; &lt;/p&gt;

---

## Correlation coefficient: `r`

**`r`** (correlation coefficient): a statistic that describes the magnitude (size) and direction (order) of a relationship

There are several types of correlation coefficients, but all assume following:

+ The **range of possible values** goes from -1 to +1
+ **Direction** is described by the sign of the coefficient (negative = negative relationship and vice versa)
+ **Magnitude** is described by the coefficient's distance from zero
    + A correlation of zero indicates an absence of correlation (no relationship)

.footnote[In statistics, a **coefficient** refers to the multiplicative factor (a numeric estimate) for one variable in relation to another variable.]

---

## Types of correlations

**Pearson product-moment**: linear relationship between two variables 
`$$x\sim\sim y$$`

**Spearman's rho**: relationship between rankings of two variables 
`$$x\sim\sim y$$`

**Intraclass**: relationship between paired observations 
`$$x_{t1}\sim\sim x_{t2}$$`

---

## Calculating `r`

**Correlation**: the covariation divided by the total variation

`$$r_{(x, y)} = \frac{cov_{(x, y)}}{s_{x}s_{y}}$$`

+ `\(s_{x}\)` and `\(s_{y}\)` are the sample standard deviations of `\(x\)` and `\(y\)` 
   - *Note*: the square root of the variance, i.e., `\(\sqrt{s^2}\)`

---

## Notable (proof)

A single variable `\(x\)` correlates perfectly with itself

`$$r_{(x, x)} = \frac{cov_{(x, x)}}{s_{x}s_{x}}$$`

+ We know from earlier `\(cov_{(x,x)}\)` is equal to `\(s_{x}^2\)` (variance)
+ And `\(s_{x}s_{x}\)` can be rewritten to `\(s_{x}^2\)`, so...

`$$r_{(x, x)} = \frac{s_{x}^2}{s_{x}^2} = 1.0$$`


---

## Rank order correlation

Calculate **Spearman's rho** the same way, only convert the observations to ranked values first.

+ **Example**: converting observations 
+ `c(7, 3, 5, 1)` to `c(4, 2, 3, 1)`


---

## Interval/ratio data


```r
## create data frame with x and y coming from random normal draws
df &lt;- data_frame(x = rnorm(20), y = x + rnorm(20))

## print
knitr::kable(df)
```

         x           y
----------  ----------
  0.271461   -1.331905
  0.608092    0.006541
  0.653852    0.031665
  0.696851    0.500203
  0.529267    1.503338
 -0.261362   -0.266860
 -0.599992   -1.320760
  0.287184   -0.383627
 -1.259698   -0.994054
  1.221563    3.059558
  0.975848    1.243411
 -0.714551   -2.100387
 -0.049158   -0.997602
  0.099992    1.540003
 -1.477704   -1.602380
 -0.602215   -0.574384
 -0.930704   -1.478507
  0.713037    2.169078
  0.060395    0.868732
  1.726288    1.588984



---

## Ordinal data


```r
## create data frame with rank (integer) data
df_ordered &lt;- data_frame(
  x = sample(1:6, 20, replace = TRUE),
  y = round((x + sample(1:6, 20, replace = TRUE)) / 2, 0))

## print
p(df_ordered)
```

<div id="htmlwidget-9863d4adfb9fec2527a4" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-9863d4adfb9fec2527a4">{"x":{"style":"bootstrap","filter":"none","fillContainer":false,"autoHideNavigation":true,"data":[["1","2","3","4","5"],[4,3,3,1,3],[2,3,4,2,4]],"container":"<table class=\"table table-striped table-hover\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>x<\/th>\n      <th>y<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[1,2]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>


---

## `cor(method = "pearson")`

By default, `cor()` returns the Pearson product-moment correlation.


```r
## using cor defaults
cor(df$x, df$y)
#&gt; [1] 0.777394
```

Use `method` to specify the type of correlation and `use` to deal with missing data


```r
## pearson product-moment correlation
cor(df$x, df$y, method = "pearson", use = "complete.obs")
#&gt; [1] 0.777394
```

---

## `cor(method = ` "spearman"`)`

Pearson product moment correlation coefficient.


```r
## pearson product-moment correlation
cor(df_ordered$x, df_ordered$y, method = "pearson")
#&gt; [1] 0.615002
```

And Spearman's rho (rank) correlation coefficient.


```r
## spearman rho correlation
cor(df_ordered$x, df_ordered$y, method = "spearman")
#&gt; [1] 0.563789
```


---

## Hypothesis testing

To conduct a signficiance test of a correlation using R, use `cor.test()`. 


```r
## correlation test
cor.test(df$x, df$y)
#&gt; 
#&gt; 	Pearson's product-moment correlation
#&gt; 
#&gt; data:  df$x and df$y
#&gt; t = 5.243, df = 18, p-value = 0.000055
#&gt; alternative hypothesis: true correlation is not equal to 0
#&gt; 95 percent confidence interval:
#&gt;  0.510488 0.907666
#&gt; sample estimates:
#&gt;      cor 
#&gt; 0.777394
```

.footnote[To convert the output to a more usable data frame, use `tidy()` from the **{broom}** package.]

---

## `method =` "pearson"

Correlation test of interval/ratio data

```r
## correlation sig test
cor.test(df$x, df$y, method = "pearson") %&gt;%
  broom::tidy() %&gt;% head()
#&gt; # A tibble: 1 x 8
#&gt;   estimate statistic p.value parameter conf.low conf.high method
#&gt;      &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt; 
#&gt; 1    0.777      5.24 5.50e-5        18    0.510     0.908 Pearsâ€¦
#&gt; # â€¦ with 1 more variable: alternative &lt;chr&gt;
```

---

## `method =` "spearman"
 
Correlation test of ordinal data

```r
## correlation sig test
cor.test(df$x, df$y, method = "spearman") %&gt;%
  broom::tidy() %&gt;% head()
#&gt; # A tibble: 1 x 5
#&gt;   estimate statistic    p.value method                          alternative
#&gt;      &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;                           &lt;chr&gt;      
#&gt; 1    0.817      244. 0.00000903 Spearman's rank correlation rho two.sided
```


---

## Correlation tool

Visualize correlations of different values (-1 to 1):

+ https://mikewk.shinyapps.io/correlation/

---

## Practice

Guess the correlation coefficient (the game):

+ http://guessthecorrelation.com/




---
class: inverse, center, middle

## Factors and factor analysis

---

## Factor

A **factor** is a psychometric term for variable. 

In statistics, factors describe the **latent** variables which we are attempting to measure. 


---

## Items

An **item** refers to a single question/prompt/response-provoking stimulus in a questionnaire.

In the context of a study, a **variable** refers to a construct (or factor) to be examined.

Variables can consist of one or more items from a questionnaire.


---

## Multi-item variables

When a variable (or factor) is measured using multiple items, we still want to represent it with one number.

**How can we represent a variable measured with 5 likert-type items using one number per observation (respondent)?**


---

## Example

Our variable of interest is extraversion/introversion. We measure it using four likert-type items:

+ I like talking to lots of people
+ I like attending events where I meet knew people
+ I am comfortable at a party where I don't know anyone else
+ Meeting my friends' friends makes me nervous


---

## Example responses


```r
## first person's responses
person1 &lt;- c(1, 2, 1, 7)

## second person's responses
person2 &lt;- c(6, 6, 5, 2)
```


---

## Factor analysis

To make sure we have **reliable** measures, we use factor analysis.

**Factor analysis** essentially finds the correlation between responses for similar items. 

There are lots of details and variations, but knowing this much will help you in the future!
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function() {
  var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})();</script>

<script>
(function() {
  var i, text, code, codes = document.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
})();
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
